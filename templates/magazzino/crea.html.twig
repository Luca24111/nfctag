{% extends 'base.html.twig' %}
{% block title %}Nuovo Prodotto{% endblock %}
{% block body %}
<link href="https://fonts.cdnfonts.com/css/sf-pro-display" rel="stylesheet">

<style>
  body {
      font-size: 1.1rem;
      font-family: 'SF Pro Text', sans-serif;
      background-color: #121212;
      color: white;
      margin: 0;
      padding: 0;
      text-align: center;
      letter-spacing: -0.04em;
  }
  .page-title {
    text-align:left;
    padding:0 1rem;
    font-size:2rem;
    color:#fff;
    padding-bottom: 1rem;
    padding-top: 1rem;
    letter-spacing: -0.04em;
  }
  .form-section {
    text-align:left;
    padding:0 1rem;
    margin-bottom:2rem;
  }
  .form-group { margin-bottom:1.5rem; }
  label {
    display:block;
    margin-bottom:0.5rem;
    color:#ccc;
    font-weight:600;
  }
  .form-control-dark {
      width:100%;
      background:#1e1e1e;
      color:#fff;
      border:1px solid #444;
      border-radius:14px;
      padding:0.8rem 1.1rem;
      font-size:0.95rem;
      transition: all .3s;
  }
  .form-control-dark:focus {
      border-color:#a020f0;
      box-shadow:0 0 8px rgba(160,32,240,0.3);
      outline:none;
  }
  .toggle-btn {
      background:#fff;
      color:#424244;
      border:none;
      border-radius:20px;
      font-size:0.8rem;
      font-weight:500;
      padding:0.6rem 1rem;
      box-shadow:0 2px 6px rgba(0,0,0,0.2);
      cursor:pointer;
  }
  .toggle-btn:hover {
      background:#f5f5f5;
      box-shadow:0 3px 8px rgba(0,0,0,0.25);
  }
</style>

<h1 class="page-title">Nuovo Prodotto</h1>

{# Gestione messaggi flash #}
{% for label, messages in app.flashes %}
    {% for message in messages %}
        <div class="alert alert-{{ label == 'error' ? 'danger' : label }}" style="margin: 1rem; padding: 1rem; border-radius: 12px; background-color: {{ label == 'error' ? '#dc3545' : '#28a745' }}; color: white;">
            {{ message }}
        </div>
    {% endfor %}
{% endfor %}

<div class="form-section">
  {{ form_start(form) }}
    <div class="form-group">
      {{ form_label(form.immagine) }}
      {{ form_widget(form.immagine, {'attr': {'class': 'form-control-dark', 'onchange': 'previewImage(event)'}}) }}
      {{ form_errors(form.immagine) }}
      <img id="image-preview" src="#" alt="Anteprima immagine" style="display:none; max-width: 100%; margin-top: 1rem; border-radius: 12px;" />
    </div>
    <div class="form-group">
      {{ form_label(form.name) }}
      {{ form_widget(form.name, {'attr':{'class':'form-control-dark'}}) }}
    </div>
    <div class="form-group">
      {{ form_label(form.scaffale) }}
      {{ form_widget(form.scaffale, {'attr': {'class': 'form-control-dark'}}) }}
      {{ form_errors(form.scaffale) }}
    </div>
    <div class="form-group">
      {{ form_label(form.description) }}
      {{ form_widget(form.description, {'attr':{'class':'form-control-dark','rows':4}}) }}
    </div>
    <button type="submit" class="toggle-btn">Salva Prodotto</button>
  {{ form_end(form) }}
</div>

<script>
  function previewImage(event) {
    const input = event.target;
    const preview = document.getElementById('image-preview');
    const file = input.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        preview.src = e.target.result;
        preview.style.display = 'block';
      };
      reader.readAsDataURL(file);
    } else {
      preview.src = '#';
      preview.style.display = 'none';
    }
  }
</script>
{% endblock %}