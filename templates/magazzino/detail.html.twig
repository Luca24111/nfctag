{# templates/magazzino/detail.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Dettaglio Prodotto{% endblock %}

{% block body %}
<link href="https://fonts.cdnfonts.com/css/sf-pro-display" rel="stylesheet">

<style>
  body {
    font-size: 1.1rem;
    font-family: 'SF Pro Text', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background-color: #121212;
    color: white;
    margin: 0; padding: 0;
    letter-spacing: -0.04em;
  }

  .detail-card {
    background-color: #1e1e1e;
    border-radius: 20px;
    margin: 1rem;
    padding: 1rem;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  }
  .detail-card h2 {
    margin: 0 0 0.75rem;
    font-size: 1.6rem;
    font-weight: 500;
  }
  .detail-row {
    margin: 0.75rem 0;
  }
  .detail-label {
    font-weight: 600; color: #b0b0b0; margin-bottom: 0.25rem;
  }
  .detail-value { color: #fff; }

  .product-image-container {
    width: 100%; height: 200px;
    border-radius: 16px; overflow: hidden;
    margin-bottom: 1rem;
  }
  .product-image-container img {
    width: 100%; height: 100%;
    object-fit: cover; object-position: top;
    display: block;
  }

  .action-buttons {
    display: flex;
    gap: 1rem;
    margin-top: 1.5rem;
  }
  .action-buttons .btn {
    flex: 1;
    padding: 0.8rem;
    font-size: 0.9rem;
    font-weight: 500;
    border-radius: 12px;
    text-decoration: none;
    text-align: center;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  .btn-modify {
    background-color: #ffffff;
    color: #424244;
    border: none;
  }
  .btn-modify:hover {
    background-color: #f5f5f5;
  }
  .btn-delete {
    background-color: #dc3545;
    color: #fff;
    border: none;
  }
  .btn-delete:hover {
    background-color: #b02a37;
  }

  .events-section {
    margin: 1.5rem 1rem;
  }
  .events-section h3 {
    font-size: 1.4rem;
    font-weight: 500;
    margin-bottom: 0.75rem;
  }
  .event-item {
    background-color: #2a2a2a;
    border-radius: 12px;
    padding: 0.75rem 1rem;
    margin-bottom: 0.75rem;
    display: flex;
    justify-content: space-between;
  }
  .event-name {
    font-weight: 600; color: #fff;
  }
  .event-meta {
    font-size: 0.85rem; color: #b0b0b0; text-align: right;
  }

  @media (min-width: 576px) {
    .detail-card { max-width: 600px; margin: 1.5rem auto; }
    .product-image-container { height: 300px; }
    .detail-card h2 { font-size: 1.8rem; }
    .events-section { max-width: 600px; margin: 2rem auto; }
  }
</style>

<div class="detail-card">
  {% if prodotto.getImage() %}
    <div class="product-image-container">
      <img src="{{ asset(prodotto.getImage()) }}" alt="Immagine di {{ prodotto.getName() }}">
    </div>
  {% endif %}

  <h2>{{ prodotto.getName() }}</h2>

  <div class="detail-row">
    <div class="detail-label">Stato:</div>
    <div class="detail-value">
      {{ prodotto.isOut() ? 'Fuori magazzino' : 'In magazzino' }}
    </div>
  </div>

  <div class="detail-row">
    <div class="detail-label">Descrizione:</div>
    <div class="detail-value">{{ prodotto.getDescription() }}</div>
  </div>

  <div class="detail-row">
    <div class="detail-label">Scaffale:</div>
    <div class="detail-value">{{ prodotto.getScaffale() ?: '-' }}</div>
  </div>

  <div class="detail-row">
    <div class="detail-label">Ult. aggiornamento:</div>
    <div class="detail-value">
      {{ prodotto.getUpdateDate() ? prodotto.getUpdateDate().format('d/m/Y H:i') : '-' }}
    </div>
  </div>

  <div class="action-buttons">
    <a href="{{ path('app_prodotto_modifica', { id: prodotto.id }) }}" class="btn btn-modify">Modifica</a>
    <form method="post" action="{{ path('app_prodotto_delete', { id: prodotto.id }) }}" onsubmit="return confirm('Eliminare questo prodotto?')" style="flex:1; margin:0;">
      <input type="hidden" name="_token" value="{{ csrf_token('delete-prodotto' ~ prodotto.id) }}">
      <button type="submit" class="btn btn-delete">Elimina</button>
    </form>
  </div>
</div>

<div class="events-section">
  <h3>Eventi associati</h3>
  {% if prodotto.getEventi()|length > 0 %}
    {% for evento in prodotto.getEventi() %}
      <div class="event-item">
        <div class="event-name">{{ evento.getNome() }}</div>
        <div class="event-meta">
          {{ evento.getData().format('d/m/Y') }}<br>
          {{ evento.getCitta() }}
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p style="color:#b0b0b0;">Nessun evento associato a questo prodotto.</p>
  {% endif %}
</div>
{% endblock %}